<div class="min-h-screen bg-gray-100">
  <!-- Meeting Room Container -->
  <div class="w-full h-full p-6">
    <!-- Title -->
    <h1 class="text-3xl font-bold mb-4 text-center">
      Meeting room: {{ callId }}
    </h1>

    <!-- Control Buttons -->
    <div class="flex justify-center space-x-4 mb-8">
      <button
        (click)="leaveCall()"
        class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 hover:cursor-pointer active:bg-red-700 transition-colors"
      >
        Leave
      </button>
      <button
        (click)="toggleMic()"
        class="px-6 py-2 text-white rounded-lg hover:cursor-pointer transition-colors"
        [class.bg-green-500]="isMicOn"
        [class.hover:bg-green-600]="isMicOn"
        [class.active:bg-green-700]="isMicOn"
        [class.bg-red-500]="!isMicOn"
        [class.hover:bg-red-600]="!isMicOn"
        [class.active:bg-red-700]="!isMicOn"
      >
        {{ isMicOn ? "Mute" : "Unmute" }}
      </button>
      <button
        (click)="toggleVideo()"
        class="px-6 py-2 text-white rounded-lg hover:cursor-pointer transition-colors"
        [class.bg-green-500]="isCameraOn"
        [class.hover:bg-green-600]="isCameraOn"
        [class.active:bg-green-700]="isCameraOn"
        [class.bg-red-500]="!isCameraOn"
        [class.hover:bg-red-600]="!isCameraOn"
        [class.active:bg-red-700]="!isCameraOn"
      >
        {{ isCameraOn ? "Turn off camera" : "Turn on camera" }}
      </button>
      <button
        (click)="toggleTranscription()"
        class="px-6 py-2 text-white rounded-lg hover:cursor-pointer transition-colors"
        [class.bg-green-500]="isTranscriptionActive"
        [class.hover:bg-green-600]="isTranscriptionActive"
        [class.active:bg-green-700]="isTranscriptionActive"
        [class.bg-gray-500]="!isTranscriptionActive"
        [class.hover:bg-gray-600]="!isTranscriptionActive"
        [class.active:bg-gray-700]="!isTranscriptionActive"
      >
        {{ isTranscriptionActive ? "Stop" : "Start" }} Live Transcription
      </button>
      <!-- <button
        (click)="toggleTranscript()"
        class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 hover:cursor-pointer active:bg-blue-700 transition-colors"
      >
        {{ showTranscript ? "Hide" : "Show" }} transcript
      </button> -->
    </div>

    <!-- Users Grid -->
    <div class="flex w-full justify-center space-x-12 px-32">
      <!-- Local User -->
      <app-user-call
        [userName]="currentUsername"
        [isMicOn]="isMicOn"
        [isCameraOn]="isCameraOn"
        [isLocalUser]="true"
        class="flex-1"
      >
      </app-user-call>

      <!-- Remote Users -->
      <app-user-call
        *ngFor="let participant of remoteParticipants; let i = index"
        [userName]="participant.name || participant.identity"
        [participantIdentity]="participant.identity"
        [isMicOn]="true"
        [isCameraOn]="true"
        [isLocalUser]="false"
        class="flex-1"
      >
      </app-user-call>

      <!-- Placeholder for when no remote users -->
      <app-user-call
        *ngIf="remoteParticipants.length === 0"
        userName="Waiting for others..."
        [isMicOn]="false"
        [isCameraOn]="false"
        [isLocalUser]="false"
        class="flex-1"
      >
      </app-user-call>
    </div>

    <!-- Transcript Section -->
    <div
      *ngIf="showTranscript"
      class="mt-8 p-4 bg-white rounded-lg shadow-md max-h-96 overflow-y-auto"
    >
      <h2 class="text-xl font-semibold mb-4">Transcript</h2>
      <div *ngFor="let message of transcript" class="mb-2">
        <strong>{{ message.sender }}:</strong> {{ message.text }}
      </div>
      <div *ngIf="transcript.length === 0" class="text-gray-500">
        No messages yet. Start the conversation!
      </div>
    </div>
  </div>
</div>
